<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Valorant Wheel Spinner</title>
  <link rel="icon" href="assets/images/icon.png" type="image/png">
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <main id="appMain">
  <!-- Role filter bar -->
  <nav id="roleFilterBar" aria-label="Agent role filters">
    <button id="roleBtnController" class="role-btn" type="button" title="Controllers" aria-pressed="false" data-role="Controller">
      <img alt="Controller" />
    </button>
    <button id="roleBtnDuelist" class="role-btn" type="button" title="Duelists" aria-pressed="false" data-role="Duelist">
      <img alt="Duelist" />
    </button>
    <button id="roleBtnInitiator" class="role-btn" type="button" title="Initiators" aria-pressed="false" data-role="Initiator">
      <img alt="Initiator" />
    </button>
    <button id="roleBtnSentinel" class="role-btn" type="button" title="Sentinels" aria-pressed="false" data-role="Sentinel">
      <img alt="Sentinel" />
    </button>
  </nav>

  <!-- Team results feed (slides in entries from the left) -->
  <aside id="teamFeed" class="team-feed" aria-live="polite"></aside>
  <div class="team-feed-controls hidden">
    <button id="teamCopyProofBtn" class="team-feed-copy modal-button" type="button" title="Copy team proof image" aria-label="Copy team proof image" disabled>‚ßâ Copy</button>
    <button id="teamFeedCloseBtn" class="team-feed-close modal-button" type="button" title="Hide team results" aria-label="Hide team results" disabled>‚úï Hide</button>
  </div>

  <!-- Canvas for the wheel spinner -->
  <div id="wheelContainer" class="loading">
    <div id="wheelLoading" class="wheel-loading" role="status" aria-live="polite">
      <div class="loading-spinner" aria-hidden="true"></div>
    </div>
    <canvas id="wheelCanvas" width="880" height="880"></canvas>
    <div id="wheelMarker" aria-hidden="true"></div>
  </div>

  <div id="winnerModal" class="modal" aria-hidden="true">
    <div class="modal-content">
      <span id="closeWinner" class="close" role="button" aria-label="Close">&times;</span>
      <div class="winner-header">
        <div class="winner-title">
          <h2 id="winnerModalName">Winner</h2>
          <p class="winner-accent">Agent Selected</p>
        </div>
      </div>
      <img id="winnerModalImage" alt="Winner Image" />
      <div class="winner-actions">
        <button id="closeWinnerBtn" type="button" class="modal-button">Close</button>
        <button id="shareWinnerBtn" class="share-clipboard-btn modal-button" type="button" title="Copy proof image" aria-label="Copy proof image" disabled>
          <span class="share-icon" aria-hidden="true">‚ßâ</span>
        </button>
      </div>
      <p id="shareStatus" class="share-status" role="status" aria-live="polite"></p>
    </div>
  </div>

  <!-- Agent list -->
  <div id="agentList"></div>

  <!-- Sound settings -->
  <!-- Settings cog and modal (sound/customization moved into modal) -->
  <button id="settingsBtn" class="settings-btn loading-gated" title="Settings">‚öôÔ∏è</button>
  <button id="teamsBtn" class="settings-btn loading-gated teams-btn" title="Teams">üë•</button>

  <div id="settingsModal" class="modal" aria-hidden="true">
    <div class="modal-content settings-modal">
      <span id="closeSettings" class="close" role="button" aria-label="Close">&times;</span>
      <h3>Spin & Audio Settings</h3>

      <div class="settings-layout">
        <section class="settings-section" id="optionsSection">
          <h4>Options</h4>
          <div class="setting-row">
            <label class="slider-label" for="usernameInput">Username</label>
            <input type="text" id="usernameInput" placeholder="Optional: show your name in results" />
          </div>
          <div class="setting-row">
            <label class="slider-label" for="pointerColor">Pointer color</label>
            <input type="color" id="pointerColor" value="#ffd45c" />
          </div>
        </section>

        <section class="settings-section" id="audioSection">
          <h4>Audio</h4>
          <p class="settings-subtitle">Configure win lines, ticks and drumroll in one place.</p>
          
          <div class="setting-row">
            <label class="toggle-label">
              <input type="checkbox" id="randomizeWinSoundsToggle">
              Randomize available voice lines
            </label>

            <div class="slider-label">
              <span>Agent win volume</span>
              <strong id="agentVolumeLabel">50%</strong>
            </div>
            <input id="agentWinVolumeRange" type="range" min="0" max="1" step="0.01" value="0.5" />
          </div>

          <div class="setting-row">
            <div class="slider-label">
              <span>Tick volume</span>
              <strong id="tickVolumeLabel">50%</strong>
            </div>
            <input id="tickVolumeRange" type="range" min="0" max="1" step="0.01" value="0.5" />
            <label class="toggle-label">
              <input type="checkbox" id="tickEnabledToggle">
              Enable tick sound
            </label>
          </div>

          <div class="setting-row">
            <div class="slider-label">
              <span>Drumroll volume</span>
              <strong id="drumrollVolumeLabel">50%</strong>
            </div>
            <input id="drumrollVolumeRange" type="range" min="0" max="1" step="0.01" value="0.5" />
            <label class="toggle-label">
              <input type="checkbox" id="drumrollEnabledToggle">
              Enable drumroll effect
            </label>
          </div>
        </section>

        <section class="settings-section" id="perAgentSection">
          <h4>Per-Agent Voice Lines</h4>
          <p class="settings-subtitle">Enable, disable, or preview individual voice lines.</p>
          <div id="perAgentSettings">
            <!-- Per-agent customization inputs filled dynamically -->
          </div>
        </section>
      </div>
    </div>
  </div>

  <!-- Teams modal -->
  <div id="teamsModal" class="modal" aria-hidden="true">
    <div class="modal-content settings-modal">
      <span id="closeTeams" class="close" role="button" aria-label="Close">&times;</span>
      <h3>Team Roll</h3>

      <div class="settings-layout">
        <section class="settings-section wide">
          <div class="setting-row">
            <label class="slider-label" for="teamNameInput">Team name</label>
            <input type="text" id="teamNameInput" placeholder="My Stack" />
          </div>

          <div id="teamPlayers" class="team-form">
            <!-- Five player rows -->
            <div class="team-player-row">
              <input type="text" class="team-player-name" placeholder="Player 1" />
              <select class="team-player-role">
                <option value="">Role‚Ä¶</option>
                <option>Controller</option>
                <option>Duelist</option>
                <option>Initiator</option>
                <option>Sentinel</option>
              </select>
            </div>
            <div class="team-player-row">
              <input type="text" class="team-player-name" placeholder="Player 2" />
              <select class="team-player-role">
                <option value="">Role‚Ä¶</option>
                <option>Controller</option>
                <option>Duelist</option>
                <option>Initiator</option>
                <option>Sentinel</option>
              </select>
            </div>
            <div class="team-player-row">
              <input type="text" class="team-player-name" placeholder="Player 3" />
              <select class="team-player-role">
                <option value="">Role‚Ä¶</option>
                <option>Controller</option>
                <option>Duelist</option>
                <option>Initiator</option>
                <option>Sentinel</option>
              </select>
            </div>
            <div class="team-player-row">
              <input type="text" class="team-player-name" placeholder="Player 4" />
              <select class="team-player-role">
                <option value="">Role‚Ä¶</option>
                <option>Controller</option>
                <option>Duelist</option>
                <option>Initiator</option>
                <option>Sentinel</option>
              </select>
            </div>
            <div class="team-player-row">
              <input type="text" class="team-player-name" placeholder="Player 5" />
              <select class="team-player-role">
                <option value="">Role‚Ä¶</option>
                <option>Controller</option>
                <option>Duelist</option>
                <option>Initiator</option>
                <option>Sentinel</option>
              </select>
            </div>
          </div>

          <h4 style="margin-top:10px">Team Role Composition</h4>
          <div id="teamComposition" class="team-comp">
            <label class="slider-label" for="compController">Controllers</label>
            <input type="number" id="compController" min="0" max="5" step="1" value="0" />
            <label class="slider-label" for="compDuelist">Duelists</label>
            <input type="number" id="compDuelist" min="0" max="5" step="1" value="0" />
            <label class="slider-label" for="compInitiator">Initiators</label>
            <input type="number" id="compInitiator" min="0" max="5" step="1" value="0" />
            <label class="slider-label" for="compSentinel">Sentinels</label>
            <input type="number" id="compSentinel" min="0" max="5" step="1" value="0" />
            <div class="settings-subtitle" style="grid-column: 1 / -1;">Unspecified slots will be filled with Any.</div>
          </div>

          <label class="toggle-label" style="margin-top:8px">
            <input type="checkbox" id="teamRandomizeRoles">
            Randomize roles among teammates
          </label>

          <div class="team-actions">
            <select id="savedTeamsSelect" title="Saved teams"></select>
            <button id="teamNewBtn" class="modal-button" type="button">New</button>
            <button id="teamSaveBtn" class="modal-button" type="button">Save</button>
            <button id="teamDeleteBtn" class="modal-button" type="button">Delete</button>
            <button id="teamRollBtn" class="modal-button" type="button">Roll Team</button>
          </div>

          <div id="teamResults" class="team-results" aria-live="polite"></div>
        </section>
      </div>
    </div>
  </div>

  <div id="debugPanel" class="debug-panel" aria-hidden="true">
    <div class="debug-panel-inner">
      <div class="debug-panel-row">
        <span class="debug-panel-title">Winner preview (debug)</span>
        <button id="debugHideBtn" type="button" class="debug-panel-close" aria-label="Hide debug panel">&times;</button>
      </div>
      <label for="debugAgentSelect" class="debug-panel-label">Preview agent</label>
      <select id="debugAgentSelect" class="debug-panel-select"></select>
      <button id="debugShowWinnerBtn" type="button" class="debug-panel-action">Show winner modal</button>
      <p class="debug-panel-hint">Press ESC to hide</p>
    </div>
  </div>

  </main>
  <script src="data/agents.js"></script>
  <script src="data/agent-sound-manifest.js"></script>
  <script src="js/base.js"></script>
  <script src="js/audio.js"></script>
  <script src="js/winner.js"></script>
  <script src="js/wheel.js"></script>
  <script src="js/ui.js"></script>
  <script src="js/debug.js"></script>
  <script src="js/data.js"></script>
</body>
</html>
